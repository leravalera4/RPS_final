# Тестирование сбора комиссий платформы

## Что было исправлено

1. **Смарт-контракт обновлен:**
   - Добавлено поле `platform_wallet` в структуру `FinalizeGame`
   - Логика перевода комиссии на кошелек платформы
   - Новый Program ID: `GstXQkBpu26KABj6YZ3pYKJhQphoQ72YL1zL38NC6D9U`

2. **Backend обновлен:**
   - Кошелек платформы: `6ayLUKjR2HUahBoRLeRKVkE6bLtUhRA9eNX7LoRFgzDt`
   - Автоматическая финализация теперь включает platform_wallet
   - Подробные логи о распределении средств

3. **Все компоненты перезапущены:**
   - Смарт-контракт передеплоен на devnet
   - Backend перезапущен с новой конфигурацией
   - IDL файлы обновлены

## Как протестировать

1. **Запустите игру с SOL-ставкой:**
   - Создайте игру с любой ставкой (0.1, 0.5 или 1+ SOL)
   - Найдите противника и сыграйте до конца

2. **Проверьте логи backend:**
   ```
   Auto-finalization complete
   Total pot: X.XXX SOL
   Platform fee (X.X%): X.XXX SOL  
   Winner receives: X.XXX SOL
   Platform wallet receives: X.XXX SOL
   ```

3. **Проверьте баланс кошелька платформы:**
   - Адрес: `6ayLUKjR2HUahBoRLeRKVkE6bLtUhRA9eNX7LoRFgzDt`
   - Проверьте в Solana Explorer (devnet)
   - Баланс должен увеличиться на размер комиссии

## Ожидаемые результаты

### Пример игры с ставкой 0.5 SOL:
- **Общий пул:** 1.0 SOL
- **Комиссия (3%):** 0.03 SOL → кошелек платформы
- **Победитель:** 0.97 SOL
- **Игровой аккаунт:** 0 SOL (полностью очищен)

### Размеры комиссий:
- ≤ 0.1 SOL: 5%
- ≤ 0.5 SOL: 3%  
- > 0.5 SOL: 2%

## Если проблемы остаются

1. Убедитесь, что backend перезапущен
2. Проверьте, что играете новую игру (не старую)
3. Проверьте логи backend на ошибки
4. Убедитесь, что используется новый Program ID
